"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[520],{7321:(n,i,e)=>{e.r(i),e.d(i,{assets:()=>l,contentTitle:()=>s,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>d});var t=e(5893),o=e(1151);const a={title:"useNavigation",new:!0,sidebar_position:void 0},s="useNavigation",r={id:"hooks/use-navigation",title:"useNavigation",description:"This hook tells you everything you need to know about a page navigation to build pending navigation indicators and optimistic UI on data mutations. Things like:",source:"@site/react-router/docs/hooks/use-navigation.md",sourceDirName:"hooks",slug:"/hooks/use-navigation",permalink:"/react-router-v6-searchable-docs/hooks/use-navigation",draft:!1,unlisted:!1,tags:[],version:"current",lastUpdatedAt:1700846349,formattedLastUpdatedAt:"Nov 24, 2023",frontMatter:{title:"useNavigation",new:!0},sidebar:"tutorialSidebar",previous:{title:"useNavigationType",permalink:"/react-router-v6-searchable-docs/hooks/use-navigation-type"},next:{title:"useOutletContext",permalink:"/react-router-v6-searchable-docs/hooks/use-outlet-context"}},l={},d=[{value:"<code>navigation.state</code>",id:"navigationstate",level:2},{value:"<code>navigation.formData</code>",id:"navigationformdata",level:2},{value:"<code>navigation.json</code>",id:"navigationjson",level:2},{value:"<code>navigation.text</code>",id:"navigationtext",level:2},{value:"<code>navigation.location</code>",id:"navigationlocation",level:2},{value:"<code>navigation.formAction</code>",id:"navigationformaction",level:2},{value:"<code>navigation.formMethod</code>",id:"navigationformmethod",level:2},{value:"<code>navigation.formEncType</code>",id:"navigationformenctype",level:2}];function c(n){const i={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.a)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.h1,{id:"usenavigation",children:(0,t.jsx)(i.code,{children:"useNavigation"})}),"\n",(0,t.jsx)(i.p,{children:"This hook tells you everything you need to know about a page navigation to build pending navigation indicators and optimistic UI on data mutations. Things like:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"Global loading indicators"}),"\n",(0,t.jsx)(i.li,{children:"Disabling forms while a mutation is happening"}),"\n",(0,t.jsx)(i.li,{children:"Adding busy indicators to submit buttons"}),"\n",(0,t.jsx)(i.li,{children:"Optimistically showing a new record while it's being created on the server"}),"\n",(0,t.jsx)(i.li,{children:"Optimistically showing the new state of a record while it's being updated"}),"\n"]}),"\n",(0,t.jsxs)("docs-warning",{children:["This feature only works if using a data router, see ",(0,t.jsx)(i.a,{href:"../routers/picking-a-router",children:"Picking a Router"})]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-js",children:'import { useNavigation } from "react-router-dom";\n\nfunction SomeComponent() {\n  const navigation = useNavigation();\n  navigation.state;\n  navigation.location;\n  navigation.formData;\n  navigation.json;\n  navigation.text;\n  navigation.formAction;\n  navigation.formMethod;\n  navigation.formEncType;\n}\n'})}),"\n",(0,t.jsxs)("docs-warning",{children:["The ",(0,t.jsx)(i.code,{children:"useNavigation().formMethod"})," field is lowercase without the ",(0,t.jsx)(i.code,{children:"future.v7_normalizeFormMethod"})," ",(0,t.jsx)(i.a,{href:"../guides/api-development-strategy",children:"Future Flag"}),". This is being normalized to uppercase to align with the ",(0,t.jsx)(i.code,{children:"fetch()"})," behavior in v7, so please upgrade your React Router v6 applications to adopt the uppercase HTTP methods."]}),"\n",(0,t.jsx)(i.h2,{id:"navigationstate",children:(0,t.jsx)(i.code,{children:"navigation.state"})}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"idle"})," - There is no navigation pending."]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"submitting"})," - A route action is being called due to a form submission using POST, PUT, PATCH, or DELETE"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"loading"})," - The loaders for the next routes are being called to render the next page"]}),"\n"]}),"\n",(0,t.jsx)(i.p,{children:"Normal navigations and GET form submissions transition through these states:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{children:"idle \u2192 loading \u2192 idle\n"})}),"\n",(0,t.jsx)(i.p,{children:"Form submissions with POST, PUT, PATCH, or DELETE transition through these states:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{children:"idle \u2192 submitting \u2192 loading \u2192 idle\n"})}),"\n",(0,t.jsx)(i.p,{children:"Here's a simple submit button that changes its text when the navigation state is changing:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-tsx",children:'function SubmitButton() {\n  const navigation = useNavigation();\n\n  const text =\n    navigation.state === "submitting"\n      ? "Saving..."\n      : navigation.state === "loading"\n      ? "Saved!"\n      : "Go";\n\n  return <button type="submit">{text}</button>;\n}\n'})}),"\n",(0,t.jsxs)(i.p,{children:["While ",(0,t.jsx)(i.code,{children:"navigation.state"})," provides the high-level state of the active navigation, you can deduce more granular information by combining it with other ",(0,t.jsx)(i.code,{children:"navigation"})," aspects:"]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-js",children:'// Is this just a normal load?\nlet isNormalLoad =\n  navigation.state === "loading" &&\n  navigation.formData == null;\n\n// Are we reloading after an action?\nlet isReloading =\n  navigation.state === "loading" &&\n  navigation.formData != null &&\n  navigation.formAction === navigation.location.pathname;\n\n// Are we redirecting after an action?\nlet isRedirecting =\n  navigation.state === "loading" &&\n  navigation.formData != null &&\n  navigation.formAction !== navigation.location.pathname;\n'})}),"\n",(0,t.jsx)(i.h2,{id:"navigationformdata",children:(0,t.jsx)(i.code,{children:"navigation.formData"})}),"\n",(0,t.jsxs)(i.p,{children:["Any POST, PUT, PATCH, or DELETE navigation that started from a ",(0,t.jsx)(i.code,{children:"<Form>"})," or ",(0,t.jsx)(i.code,{children:"useSubmit"}),' will have your form\'s submission data attached to it. This is primarily useful to build "Optimistic UI" with the ',(0,t.jsx)(i.code,{children:"submission.formData"})," ",(0,t.jsx)(i.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/FormData",children:(0,t.jsx)(i.code,{children:"FormData"})})," object."]}),"\n",(0,t.jsxs)(i.p,{children:["In the case of a GET form submission, ",(0,t.jsx)(i.code,{children:"formData"})," will be empty and the data will be reflected in ",(0,t.jsx)(i.code,{children:"navigation.location.search"}),"."]}),"\n",(0,t.jsx)(i.h2,{id:"navigationjson",children:(0,t.jsx)(i.code,{children:"navigation.json"})}),"\n",(0,t.jsxs)(i.p,{children:["Any POST, PUT, PATCH, or DELETE navigation that started from a ",(0,t.jsx)(i.code,{children:'useSubmit(payload, { encType: "application/json" })'})," will have your JSON value available in ",(0,t.jsx)(i.code,{children:"navigation.json"}),"."]}),"\n",(0,t.jsx)(i.h2,{id:"navigationtext",children:(0,t.jsx)(i.code,{children:"navigation.text"})}),"\n",(0,t.jsxs)(i.p,{children:["Any POST, PUT, PATCH, or DELETE navigation that started from a ",(0,t.jsx)(i.code,{children:'useSubmit(payload, { encType: "text/plain" })'})," will have your text value available in ",(0,t.jsx)(i.code,{children:"navigation.text"}),"."]}),"\n",(0,t.jsx)(i.h2,{id:"navigationlocation",children:(0,t.jsx)(i.code,{children:"navigation.location"})}),"\n",(0,t.jsxs)(i.p,{children:["This tells you what the next ",(0,t.jsx)(i.a,{href:"../utils/location",children:"location"})," is going to be."]}),"\n",(0,t.jsx)(i.p,{children:'Note that this link will not appear "pending" if a form is being submitted to the URL the link points to, because we only do this for "loading" states. The form will contain the pending UI for when the state is "submitting", once the action is complete, then the link will go pending.'}),"\n",(0,t.jsx)(i.h2,{id:"navigationformaction",children:(0,t.jsx)(i.code,{children:"navigation.formAction"})}),"\n",(0,t.jsxs)(i.p,{children:["Any POST, PUT, PATCH, or DELETE navigation that started from a ",(0,t.jsx)(i.code,{children:"<Form>"})," or ",(0,t.jsx)(i.code,{children:"useSubmit"})," will have form's submission action route's path value available in ",(0,t.jsx)(i.code,{children:"navigation.formAction"}),"."]}),"\n",(0,t.jsxs)(i.p,{children:["In the case of a GET form submission, ",(0,t.jsx)(i.code,{children:"navigation.formAction"})," will be empty"]}),"\n",(0,t.jsxs)(i.p,{children:["If you submitted the form at ",(0,t.jsx)(i.code,{children:"example.com/id"}),", then ",(0,t.jsx)(i.code,{children:"navigation.formAction"}),' would be "/id"']}),"\n",(0,t.jsx)(i.h2,{id:"navigationformmethod",children:(0,t.jsx)(i.code,{children:"navigation.formMethod"})}),"\n",(0,t.jsxs)(i.p,{children:["Any POST, PUT, PATCH, or DELETE navigation that started from a ",(0,t.jsx)(i.code,{children:"<Form>"})," or ",(0,t.jsx)(i.code,{children:"useSubmit"})," will have form's submission method value available in ",(0,t.jsx)(i.code,{children:"navigation.formMethod"}),"."]}),"\n",(0,t.jsxs)(i.p,{children:["In the case of a GET form submission, ",(0,t.jsx)(i.code,{children:"navigation.formMethod"})," will be empty"]}),"\n",(0,t.jsxs)(i.p,{children:["Here is an example. Please note that ",(0,t.jsx)(i.code,{children:"navigation.formMethod"})," is in lowercase"]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-tsx",children:'function SubmitButton() {\n  const navigation = useNavigation();\n  if (navigation.formMethod) {\n    console.log(navigation.formMethod); // post\n  }\n\n  return (\n    <Form method="POST">\n      <button>Submit</button>\n    </Form>\n  );\n}\n'})}),"\n",(0,t.jsx)(i.h2,{id:"navigationformenctype",children:(0,t.jsx)(i.code,{children:"navigation.formEncType"})}),"\n",(0,t.jsxs)(i.p,{children:["Any POST, PUT, PATCH, or DELETE navigation that started from a ",(0,t.jsx)(i.code,{children:"<Form>"})," or ",(0,t.jsx)(i.code,{children:"useSubmit"})," will have form's submission method value available in ",(0,t.jsx)(i.code,{children:"navigation.formEncType"}),"."]}),"\n",(0,t.jsx)(i.p,{children:'This property can be one of the four values: "text/plain," "application/json," "multipart/form-data," or "application/x-www-form-urlencoded."'}),"\n",(0,t.jsxs)(i.p,{children:["In the case of a GET form submission, ",(0,t.jsx)(i.code,{children:"navigation.formEncType"})," will be empty"]})]})}function h(n={}){const{wrapper:i}={...(0,o.a)(),...n.components};return i?(0,t.jsx)(i,{...n,children:(0,t.jsx)(c,{...n})}):c(n)}},1151:(n,i,e)=>{e.d(i,{Z:()=>r,a:()=>s});var t=e(7294);const o={},a=t.createContext(o);function s(n){const i=t.useContext(a);return t.useMemo((function(){return"function"==typeof n?n(i):{...i,...n}}),[i,n])}function r(n){let i;return i=n.disableParentContext?"function"==typeof n.components?n.components(o):n.components||o:s(n.components),t.createElement(a.Provider,{value:i},n.children)}}}]);
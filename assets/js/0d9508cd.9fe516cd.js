"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4822],{1976:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>d});var a=t(5893),r=t(1151);const o={title:"shouldRevalidate",new:!0,sidebar_position:void 0},i="shouldRevalidate",s={id:"route/should-revalidate",title:"shouldRevalidate",description:"Type declaration",source:"@site/react-router/docs/route/should-revalidate.md",sourceDirName:"route",slug:"/route/should-revalidate",permalink:"/react-router-v6-searchable-docs/route/should-revalidate",draft:!1,unlisted:!1,tags:[],version:"current",lastUpdatedAt:1697564998,formattedLastUpdatedAt:"Oct 17, 2023",frontMatter:{title:"shouldRevalidate",new:!0},sidebar:"tutorialSidebar",previous:{title:"loader",permalink:"/react-router-v6-searchable-docs/route/loader"},next:{title:"Components",permalink:"/react-router-v6-searchable-docs/components/index"}},l={},d=[];function c(e){const n={a:"a",code:"code",em:"em",h1:"h1",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.a)(),...e.components},{Details:t}=n;return t||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h1,{id:"shouldrevalidate",children:(0,a.jsx)(n.code,{children:"shouldRevalidate"})}),"\n",(0,a.jsxs)(t,{children:[(0,a.jsx)("summary",{children:"Type declaration"}),(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:'interface ShouldRevalidateFunction {\n  (args: ShouldRevalidateFunctionArgs): boolean;\n}\n\ninterface ShouldRevalidateFunctionArgs {\n  currentUrl: URL;\n  currentParams: AgnosticDataRouteMatch["params"];\n  nextUrl: URL;\n  nextParams: AgnosticDataRouteMatch["params"];\n  formMethod?: Submission["formMethod"];\n  formAction?: Submission["formAction"];\n  formEncType?: Submission["formEncType"];\n  text?: Submission["text"];\n  formData?: Submission["formData"];\n  json?: Submission["json"];\n  actionResult?: any;\n  defaultShouldRevalidate: boolean;\n}\n'})})]}),"\n",(0,a.jsxs)(n.p,{children:["This function allows you opt-out of revalidation for a route's ",(0,a.jsx)(n.a,{href:"./loader",children:"loader"})," as an optimization."]}),"\n",(0,a.jsxs)("docs-warning",{children:["This feature only works if using a data router, see ",(0,a.jsx)(n.a,{href:"../routers/picking-a-router",children:"Picking a Router"})]}),"\n",(0,a.jsx)(n.p,{children:"There are several instances where data is revalidated, keeping your UI in sync with your data automatically:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["After an ",(0,a.jsx)(n.a,{href:"./action",children:(0,a.jsx)(n.code,{children:"action"})})," is called from a ",(0,a.jsx)(n.a,{href:"../components/form",children:(0,a.jsx)(n.code,{children:"<Form>"})}),"."]}),"\n",(0,a.jsxs)(n.li,{children:["After an ",(0,a.jsx)(n.a,{href:"./action",children:(0,a.jsx)(n.code,{children:"action"})})," is called from a ",(0,a.jsx)(n.a,{href:"../hooks/use-fetcher",children:(0,a.jsx)(n.code,{children:"<fetcher.Form>"})})]}),"\n",(0,a.jsxs)(n.li,{children:["After an ",(0,a.jsx)(n.a,{href:"./action",children:(0,a.jsx)(n.code,{children:"action"})})," is called from ",(0,a.jsx)(n.a,{href:"../hooks/use-submit",children:(0,a.jsx)(n.code,{children:"useSubmit"})})]}),"\n",(0,a.jsxs)(n.li,{children:["After an ",(0,a.jsx)(n.a,{href:"./action",children:(0,a.jsx)(n.code,{children:"action"})})," is called from a ",(0,a.jsx)(n.a,{href:"../hooks/use-fetcher",children:(0,a.jsx)(n.code,{children:"fetcher.submit"})})]}),"\n",(0,a.jsxs)(n.li,{children:["When an explicit revalidation is triggered via ",(0,a.jsx)(n.a,{href:"../hooks/use-revalidator",children:(0,a.jsx)(n.code,{children:"useRevalidator"})})]}),"\n",(0,a.jsxs)(n.li,{children:["When the ",(0,a.jsx)(n.a,{href:"./route#dynamic-segments",children:"URL params"})," change for an already rendered route"]}),"\n",(0,a.jsx)(n.li,{children:"When the URL Search params change"}),"\n",(0,a.jsx)(n.li,{children:"When navigating to the same URL as the current URL"}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["If you define ",(0,a.jsx)(n.code,{children:"shouldRevalidate"})," on a route, it will first check the function before calling the route loader for new data. If the function returns ",(0,a.jsx)(n.code,{children:"false"}),", then the loader ",(0,a.jsx)(n.em,{children:"will not"})," be called and the existing data for that loader will persist on the page."]}),"\n",(0,a.jsx)("docs-info",{children:(0,a.jsx)(n.p,{children:"Fetcher loads also revalidate, but because they load a specific URL, they don't have to worry about the URL-driven revalidation scenarios above.  Fetcher loads only revalidate by default after action submissions and explicit revalidation requests."})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-jsx",metastring:"lines=[5-9,14-15,21-22]",children:'<Route\n  path="meals-plans"\n  element={<MealPlans />}\n  loader={loadMealPlans}\n  shouldRevalidate={({ currentUrl }) => {\n    // only revalidate if the submission originates from\n    // the `/meal-plans/new` route.\n    return currentUrl.pathname === "/meal-plans/new";\n  }}\n>\n  <Route\n    path="new"\n    element={<NewMealPlanForm />}\n    // `loadMealPlans` will be revalidated after\n    // this action...\n    action={createMealPlan}\n  />\n  <Route\n    path=":planId/meal"\n    element={<Meal />}\n    // ...but not this one because origin the URL\n    // is not "/meal-plans/new"\n    action={updateMeal}\n  />\n</Route>\n'})}),"\n",(0,a.jsx)(n.p,{children:"Note that this is only for data that has already been loaded, is currently rendered, and will continue to be rendered at the new URL. Data for new routes and fetchers at the new URL will always be fetched initially."}),"\n",(0,a.jsx)("docs-warning",{children:"Using this API risks your UI getting out of sync with your data, use with caution!"})]})}function h(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},1151:(e,n,t)=>{t.d(n,{Z:()=>s,a:()=>i});var a=t(7294);const r={},o=a.createContext(r);function i(e){const n=a.useContext(o);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),a.createElement(o.Provider,{value:n},e.children)}}}]);